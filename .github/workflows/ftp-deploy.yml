name: Deploy to FTP Server

on:
  push:
    branches:
      - master

jobs:
  ftp-deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Deploy Files to FTP Server
      uses: SamKirkland/FTP-Deploy-Action@4.3.0
      with:
        server: ftpupload.net
        username: ${{ secrets.FTP_USERNAME }}
        password: ${{ secrets.FTP_PASSWORD }}
        server-dir: /htdocs/
        local-dir: ./  # Make sure this is pointing to the root directory of your repo
        exclude: 'node_modules/**,**/dist/**,**/build/**,**.git/**'  # Excluding unwanted folders
        include: '*'  # Including all other files
        overwrite: true  # Overwrite files if needed
        cleanup: false  # Disable cleanup unless you want to remove old files
        dry-run: false  # Set to false to actually deploy

    - name: Deploy .htaccess to FTP Server
      uses: SamKirkland/FTP-Deploy-Action@4.3.0
      with:
        server: ftpupload.net
        username: ${{ secrets.FTP_USERNAME }}
        password: ${{ secrets.FTP_PASSWORD }}
        server-dir: /  # This should be the root directory where your .htaccess file should go
        local-dir: ./  # Assuming .htaccess is in the root of your repo
        exclude: '**/*'  # Exclude all files
        include: '.htaccess'  # Only include .htaccess file
        overwrite: true  # Overwrite .htaccess if needed
        cleanup: false  # Disable cleanup for .htaccess file deployment
        dry-run: false  # Set to false to actually deploy
